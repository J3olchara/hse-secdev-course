# Конфиг для Gitleaks - ищем секреты, но не паримся по ложнякам
title = "wishlist gitleaks config"

[extend]
# Используем дефолтные правила Gitleaks - там уже куча паттернов для AWS, GitHub, etc

[allowlist]
description = "реальные false positives из нашего проекта"

# Папки где точно не секреты
paths = [
  "EVIDENCE/",
  "docs/",
  "tests/",
  ".github/workflows/",
]

commits = []

# Конкретные паттерны которые не секреты
regexes = [
  # Тестовые токены для CI/тестов
  "TEST_SECRET_DO_NOT_USE",
  "test-secret-key",
  "fake-token-for-tests",
  
  # Да, это тот самый dev-ключ который торчит в config.py для локалки
  # В проде он и так из env берется, так что это не уязвимость
  "dev-secret-key-DO-NOT-USE-IN-PRODUCTION",
  
  # JWT примеры и фейковые токены в тестах
  "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.*",
  
  # Дефолтные значения для docker-compose (не используются в проде)
  "wishlist_password",
  "wishlist_user",
  
  # Placeholder'ы и примеры из документации
  "your-secret-key-here",
  "change-me-in-production",
  "example.*secret",
  "SECRET_KEY_HERE",
  
  # Технические строки которые выглядят как секреты но не являются
  "ALGORITHM",
  "SECRET_KEY",
  "POSTGRES_PASSWORD",
]

# Коммиты где точно ничего секретного (если понадобится)
# commits = ["abc123..."]

# Пути к конкретным файлам где можно игнорить (если нужно)
# [allowlist.paths]
# description = "specific files"
# paths = [
#   "env.example",
# ]
